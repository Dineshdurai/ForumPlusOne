/*! forumplusone - 2016-06-24 */
!function(){function a(){window.onloadFnc=window.onloadFnc||[];var a,b;for(a=0,b=window.onloadFnc.length;b>a;++a)window.onloadFnc[a].call()}if(!window.jQueryLoaderAlreadyLaunch)if(window.jQueryLoaderAlreadyLaunch=!0,"undefined"==typeof jQuery){var b,c=document.createElement("script"),d=document.getElementsByTagName("head")[0],e=!1,f=location.pathname.lastIndexOf("/");if(-1==f)throw new Error("WTF (What Terible Failure) ! I don't reconize the URL to load jQuery !");b=location.pathname.substring(0,f+1)+"js/",c.src=location.origin+b+"jquery.min.js",c.onload=c.onreadystatechange=function(){(e||this.readyState)&&"loaded"!=this.readyState&&"complete"!=this.readyState||(e=!0,c.onload=c.onreadystatechange=null,jQuery(function(){a()}))},d.appendChild(c)}else a()}(window,document),function(){"use strict";function a(){function a(a,b){var c=$.parseHTML('<div class="votersPanel"><span aria-hidden="true" class="arrow"></span><button class="closeBtn">&times;</button><h4>'+window.jQueryStrings.votersPanelTitle+'</h4><div><table class="table table-hover"><thead></thead><tbody></tbody></table></div></div>'),d=$(c).insertAfter(b);return d.find(".arrow").offset({left:a.offset().left+a.outerWidth()/2}),d}function c(a,b){var c,d,e,f,g=a.find("table"),h=g.find("thead"),i=g.find("tbody");if(h.empty(),i.empty(),b.votes.length<1)return void $('<tr><td style="text-align:center">'+window.jQueryStrings.thereNoVoteHere+"</td></tr>").appendTo(i);for(b.votes[0].datetime&&(e=!0),f=$("<tr><th></th><th><a>"+window.jQueryStrings.tableTitleName+"</a></th></tr>").appendTo(h),e&&f.append("<th><a>"+window.jQueryStrings.tableTitleDatetime+"</a></th>"),c=0,d=b.votes.length;d>c;++c)f=$("<tr><td>"+b.votes[c].usrpicture+"</td><td>"+b.votes[c].fullname+"</td></tr>").appendTo(i),e&&f.append("<td>"+b.votes[c].datetime+"</td>")}function d(a,b){a.find(".closeBtn").on("click",function(){a.hide(150,function(){$(this).remove()})});var e=a.find("th");e.on("click",function(){var f=e.index(this);0!=f&&(b.votes=b.votes.sort(function(a,b){switch(f){case 1:return a.fullname.localeCompare(b.fullname);case 2:return a.timestamp-b.timestamp}}),c(a,b),d(a,b))})}var e=function(){var b=jQuery(".forumplusone-show-voters-link");b.on("click",function(e){var f,g,h=location.pathname.lastIndexOf("/"),i=$(this);if(-1==h)throw new Error("WTF (What Terible Failure) ! I don't reconize the URL");f=location.pathname.substring(0,h+1)+"js/",g=location.origin+f+"jquery.min.js",jQuery.ajax({url:M.cfg.wwwroot+"/mod/forumplusone/route.php",data:{action:"whovote",postid:i.parents("[data-postid]").attr("data-postid"),contextid:b.attr("href").match(/contextid=(\d+)/)[1]},dataType:"json",success:function(b,e,f){if($(".votersPanel .closeBtn").trigger("click"),0!=b.errorCode)return void f.fail();var g=i.parents(".forumplusone-post-target").first(),h=a(i,g);c(h,b),d(h,b),h.find("div").height()>h.find("table").outerHeight(!0)&&h.height(h.height()-(h.find("div").height()-h.find("table").outerHeight(!0)-1)),h.hide(),h.show(150),$(i).scrollTo()},error:function(a,b,c){var d={url:i.attr("href"),name:"showVoters",options:"height=400,width=600,top=0,left=0,menubar=0,location=0,scrollbars,resizable,toolbar,status,directories=0,fullscreen=0,dependent"};-1===d.url.indexOf("?")?d.url+="?popup=1":d.url+="&popup=1",openpopup.apply(i.get(),[e,d])&&(location.href=link.getAttribute("href"))}}),e.preventDefault()})};e(),jQuery.fn.extend({scrollTo:function(){var a=$("html, body"),c={},d={};return c.scrollTop=this.offset().top-$(".navbar-fixed-top").outerHeight()-b,c.scrollLeft=this.offset().left,d.transitionDuration=d.transitionDuration||150,d.transitionTimingFunction=d.transitionTimingFunction||"swing",a.animate(c,d.transitionDuration,d.transitionTimingFunction),a.on("scroll mousedown DOMMouseScroll mousewheel keyup",function(b){(b.which>0||"mousedown"===b.type||"mousewheel"===b.type)&&a.stop().off("scroll mousedown DOMMouseScroll mousewheel keyup")}),this}}),jQuery(document.body).on("discussion:created",e),jQuery(document.body).on("discussion:deleted",e),jQuery(document.body).on("form:canceled",e),jQuery(document.body).on("post:created",e),jQuery(document.body).on("post:deleted",e),jQuery(document.body).on("post:updated",e)}var b=100;window.onloadFnc=window.onloadFnc||[],window.onloadFnc.push(a)}(window,document);
//# sourceMappingURL=seevoters.min.js.map